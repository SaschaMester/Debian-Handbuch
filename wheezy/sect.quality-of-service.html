<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>10.3. Quality of Service</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.1.5" /><meta name="package" content="Debian-debian-handbook-7-de-DE-1.0-1" /><meta name="keywords" content="Netzwerk, Gateway, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link rel="home" href="index.html" title="Das Debian Administrationshandbuch" /><link rel="up" href="network-infrastructure.html" title="Kapitel 10. Netzwerk-Infrastruktur" /><link rel="prev" href="sect.virtual-private-network.html" title="10.2. Virtual Private Network" /><link rel="next" href="sect.dynamic-routing.html" title="10.4. Dynamisches Routing" /></head><body><p id="title"><a class="left" href="http://www.debian.org"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="http://debian-handbook.info"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul class="docnav top"><li class="previous"><a accesskey="p" href="sect.virtual-private-network.html"><strong>Zurück</strong></a></li><li class="home">Das Debian Administrationshandbuch</li><li class="next"><a accesskey="n" href="sect.dynamic-routing.html"><strong>Weiter</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h2 class="title"><a xmlns="" id="sect.quality-of-service"></a>10.3. Quality of Service</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="sect.qos-principe"></a>10.3.1. Prinzip und Mechanismus</h3></div></div></div><div class="para">
				<span class="emphasis"><em>Quality of Service</em></span> (oder kurz <span class="emphasis"><em>QoS</em></span>) bezeichnet eine Reihe von Techniken, die die Qualität der Dienste sicherstellen oder verbessern, die für Anwendungen bereitgestellt werden. Die populärste Technik besteht in der Einstufung des Netzverkehrs in Kategorien und der Differenzierung des Datenverkehrs nach Kategorien. Die Hauptanwendung dieses differenzierten Dienstekonzepts ist <span class="emphasis"><em>traffic shaping</em></span>, das die Datenübertragungsraten für Verbindungen im Zusammenhang mit einigen Diensten oder Rechnern begrenzt, um nicht die verfügbare Bandbreite auszuschöpfen und wichtige andere Dienste auszubremsen. Traffic Shaping eignet sich besonders gut für TCP-Datenverkehr, da sich dieses Protokoll automatisch auf die verfügbare Bandbreite einstellt.
			</div><a id="idm139785324883552" class="indexterm"></a><a id="idm139785324882592" class="indexterm"></a><a id="idm139785324881632" class="indexterm"></a><a id="idm139785324880192" class="indexterm"></a><div class="para">
				Es ist auch möglich die Prioritäten für den Datenverkehr zu ändern, wodurch Pakete interaktiver Dienste (wie <code class="command">ssh</code> und <code class="command">telnet</code>) oder von Diensten mit kleinen Datenblöcken bevorzugt werden.
			</div><div class="para">
				Die Debian-Kernel enthalten die für QoS erforderlichen Funktionen und die dazugehörigen Module. Diese Module sind zahlreich, und jedes von ihnen stellt einen anderen Dienst bereit, vor allem mittels spezieller Steuerprogramme für die Warteschlangen der IP-Pakete; die große Vielfalt der Verhaltensweisen der verfügbaren Steuerprogramme deckt den gesamten Bereich möglicher Anforderungen ab.
			</div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>KULTUR</em></span> LARTC — <span class="emphasis"><em>Linux Advanced Routing &amp; Traffic Control</em></span></strong></p></div></div></div><div class="para">
				Das HOWTO <span class="emphasis"><em>Linux Advanced Routing &amp; Traffic Control</em></span> ist das Referenzdokument, das alles zum Thema Quality of Service von Netzwerken behandelt. <div xmlns="" class="url">→ <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.lartc.org/howto/">http://www.lartc.org/howto/</a></div>
			</div><a id="idm139785324873328" class="indexterm"></a><a id="idm139785324871888" class="indexterm"></a><a id="idm139785324870448" class="indexterm"></a></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="sect.qos-config"></a>10.3.2. Konfigurieren und Ausführen</h3></div></div></div><div class="para">
				QoS-Parameter werden mit dem Befehl <code class="command">tc</code> gesetzt (vom Paket <span class="pkg pkg">iproute</span> bereitgestellt). Da diese Schnittstelle recht komplex ist, ist die Verwendung von Programmen auf höherer Ebene empfehlenswert.
			</div><a id="idm139785324866464" class="indexterm"></a><a id="idm139785324865344" class="indexterm"></a><div class="section"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.qos-wondershaper"></a>10.3.2.1. Latenzzeiten verringern: <code class="command">wondershaper</code></h4></div></div></div><div class="para">
					Die Hauptaufgabe von <code class="command">wondershaper</code> (in dem Paket ähnlichen Namens) besteht darin, Latenzzeiten unabhängig von der Netzauslastung zu minimieren. Dies wird dadurch erreicht, dass der gesamte Datenverkehr auf einen Wert begrenzt wird, der gerade unterhalb des Wertes für die vollständige Auslastung der Verbindung liegt.
				</div><a id="idm139785324861680" class="indexterm"></a><a id="idm139785324860560" class="indexterm"></a><a id="idm139785324859632" class="indexterm"></a><div class="para">
					Sobald eine Netzwerkschnittstelle konfiguriert ist, wird das Einstellen der Datenverkehrsbegrenzung durch das Ausführen von <code class="command">wondershaper <em class="replaceable"><code>schnittstelle</code></em> <em class="replaceable"><code>download_rate</code></em> <em class="replaceable"><code>upload_rate</code></em></code> erreicht. Die Schnittstelle kann zum Beispiel <code class="literal">eth0</code> oder <code class="literal">ppp0</code> sein, und beide Raten werden in Kilobits pro Sekunde ausgedrückt. Der Befehl <code class="command">wondershaper remove <em class="replaceable"><code>schnittstelle</code></em></code> unterbindet die Datenverkehrskontrolle an der genannten Schnittstelle.
				</div><div class="para">
					Für eine Ethernetverbindung wird dieses Skript am besten unmittelbar nach der Konfiguration der Schnittstelle aufgerufen. Dies geschieht, indem <code class="literal">up</code>- und <code class="literal">down</code>-Anweisungen zur Datei <code class="filename">/etc/network/interfaces</code> hinzugefügt werden, die es den angegebenen Befehlen erlauben zu laufen, nachdem die Schnittstelle konfiguriert beziehungsweise bevor sie dekonfiguriert wird. Zum Beispiel:
				</div><div class="example"><a xmlns="" id="example.network-interfaces"></a><p class="title"><strong>Beispiel 10.9. Änderungen in der Datei <code class="filename">/etc/network/interfaces</code></strong></p><div class="example-contents"><pre class="programlisting">
iface eth0 inet dhcp
    up /sbin/wondershaper eth0 500 100
    down /sbin/wondershaper remove eth0
</pre></div></div><br class="example-break" /><div class="para">
					Im Falle von PPP aktiviert ein Skript, das <code class="command">wondershaper</code> in <code class="filename">/etc/ppp/ip-up.d/</code> aufruft, die Datenverkehrskontrolle, sobald die Verbindung steht.
				</div><div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>WEITERE SCHRITTE</em></span> Optimale Konfiguration</strong></p></div></div></div><div class="para">
					Die Datei <code class="filename">/usr/share/doc/wondershaper/README.Debian.gz</code> beschreibt recht genau die vom Paketbetreuer empfohlene Konfiguration. Insbesondere rät es dazu, die Upload- und Downloadgeschwindigkeit zu messen, um so am besten die tatsächlichen Grenzen abzuschätzen.
				</div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.qos-config-standard"></a>10.3.2.2. Standard-Konfiguration</h4></div></div></div><div class="para">
					Falls es keine besondere QoS-Konfiguration gibt, verwendet der Linux-Kernel das Warteschlangen-Steuerprogramm <code class="literal">pfifo_fast</code>, das selbst einige interessante Funktionen aufweist. Die Priorität jedes verarbeiteten IP-Pakets hängt von dessen ToS-Feld (<span class="emphasis"><em>Type of Service</em></span>) ab; es genügt, dieses Feld zu ändern, um die zeitlichen Steuerungsfunktionen zu nutzen. Es gibt fünf mögliche Werte:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							Normal-Service (0);
						</div></li><li class="listitem"><div class="para">
							Minimize-Cost (2);
						</div></li><li class="listitem"><div class="para">
							Maximize-Reliability (4);
						</div></li><li class="listitem"><div class="para">
							Maximize-Throughput (8);
						</div></li><li class="listitem"><div class="para">
							Minimize-Delay (16).
						</div></li></ul></div><a id="idm139785310844720" class="indexterm"></a><a id="idm139785310843760" class="indexterm"></a><div class="para">
					Das ToS-Feld kann durch Anwendungen, die IP-Pakete erzeugen, erstellt oder im laufenden Betrieb mit <span class="emphasis"><em>netfilter</em></span> verändert werden. Die folgenden Regeln genügen, um die Ansprechbarkeit des SSH-Dienstes eines Servers zu erhöhen:
				</div><pre class="programlisting scale">
iptables -t mangle -A PREROUTING -p tcp --sport ssh -j TOS --set-tos Minimize-Delay
iptables -t mangle -A PREROUTING -p tcp --dport ssh -j TOS --set-tos Minimize-Delay
</pre></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="sect.virtual-private-network.html"><strong>Zurück</strong>10.2. Virtual Private Network</a></li><li class="up"><a accesskey="u" href="#"><strong>Nach oben</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Zum Anfang</strong></a></li><li class="next"><a accesskey="n" href="sect.dynamic-routing.html"><strong>Weiter</strong>10.4. Dynamisches Routing</a></li></ul></body></html>